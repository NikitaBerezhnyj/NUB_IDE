"use client";
var e=require("react/jsx-runtime"),t=require("react");function n(e,t,n,o){var r=e.ownerDocument;o||(o=r.createRange());let i,l,s,u=r.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1),c={},d={};for(;i=u.nextNode();)l=i.nodeValue,s=l.length,!c.node&&s>t&&(c.node=i,c.offset=t),!d.node&&s>=n&&(d.node=i,d.offset=n),t-=s,n-=s;return c.node&&o.setStart(c.node,c.offset),d.node&&o.setEnd(d.node,d.offset),o}const o="current",r=e.jsx("span",{style:{color:"transparent"},children:"â€‹"}),i=["direction","padding","paddingTop","paddingBottom","paddingLeft","paddingRight","margin","marginTop","marginBottom","marginLeft","marginRight","border","borderWidth","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","borderStyle","borderTopStyle","borderBottomStyle","borderLeftStyle","borderRightStyle","fontSize","fontFamily","fontStyle","fontVariant","fontWeight","fontStretch","fontSizeAdjust","textAlign","textTransform","textIndent","letterSpacing","wordSpacing","lineHeight","whiteSpace","wordBreak","overflowWrap","tabSize","MozTabSize"],l=(e,t)=>e.getPropertyValue(t),s=(e,t,n)=>{e.setProperty(t,n)},u=(e,t)=>{const n=l(e,t);return n?parseInt(n,10):0},c=e=>getComputedStyle(e),d=e=>"string"==typeof e&&e.endsWith("%"),a=e=>u(e,"padding-top")+u(e,"padding-bottom")+u(e,"border-top")+u(e,"border-bottom"),p=e=>u(e,"padding-left")+u(e,"padding-right")+u(e,"border-left")+u(e,"border-right"),h=(e,t,n)=>{const o="pointer-events",r=e.style,i=t.style,u=l(r,o),c=l(i,o);s(r,o,"none"),s(i,o,"auto");const d=document.elementFromPoint(n.clientX,n.clientY);return s(r,o,u),s(i,o,c),f(d,t)?d:null},f=(e,t)=>!!e&&t!==e&&t.contains(e),g=(e,t,n)=>{e.dispatchEvent(new MouseEvent(t,n))},b=(e,t)=>{g(e,t.type,t)},v=(e,t)=>{e&&g(e,"mouseout",t)},S=e=>{e.stopPropagation()},m=(e,t,n,r)=>{const s=c(e),u=e.style,d=t.style;n[o]||(n[o]=l(s,"color")),i.forEach((e=>{d[e]=s[e]})),u.color=d.borderColor="transparent",u.caretColor=(null==r?void 0:r.caretColor)||n[o]},y=(e,t,n)=>(e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}),x=(e,t)=>{let n,r=[null,null];const i={t(){setTimeout((()=>{t((()=>{const e=i.o(),t=i.i();return r[0]===e&&r[1]===t||(r=[e,t]),r})())}))},l(e){n=e},o(){const t=e[o];if(!t)return 0;const r=t.selectionStart;return n?Math.min(r,t.selectionEnd-n.data.length):r},i(){const t=e[o];if(!t)return 0;const r=t.selectionEnd;return n?Math.min(r,t.selectionStart+n.data.length):r}};return i},w="undefined"!=typeof window?t.useLayoutEffect:t.useEffect,M=e=>{const n=t.useRef();return n[o]||(n[o]=e())},_=(e,t,n,o,r)=>{let i=null;const l=new ResizeObserver((([t])=>{const{contentRect:{width:n,height:r},borderBoxSize:i}=t;if(i&&i[0])return void o([n,r,i[0].inlineSize-n,i[0].blockSize-r]);const l=c(e);o([n,r,p(l),a(l)])})),s=y(e,"focus",(()=>{r(!0)})),u=y(e,"blur",(()=>{r(!1)})),d=y(e,"scroll",(()=>{const{scrollTop:n,scrollLeft:o}=e;t.style.transform=`translate(${-o}px, ${-n}px)`})),f=y(e,"mousedown",(o=>{n.t();const r=y(document,"mouseup",(()=>{n.t(),r()})),i=h(e,t,o);i&&b(i,o)})),S=y(e,"mouseup",(n=>{const o=h(e,t,n);o&&b(o,n)})),m=y(e,"mousemove",(n=>{const o=h(e,t,n);((e,t,n)=>{e&&b(e,n),t!==e&&(v(t,n),e&&g(e,"mouseover",n))})(o,i,n),i=o})),x=y(e,"mouseleave",(e=>{v(i,e),i=null})),w=y(e,"click",(n=>{const o=h(e,t,n);o&&b(o,n)})),M=y(e,"input",(()=>{n.t()})),_=y(e,"compositionstart",(e=>{n.l(e)})),k=y(e,"compositionupdate",(e=>{n.l(e)})),z=y(e,"compositionend",(()=>{n.l()}));return l.observe(e),()=>{s(),u(),d(),f(),S(),m(),x(),w(),M(),_(),k(),z(),l.disconnect()}},k=t.memo((({u:n,p:o,h:i,g:l})=>{const[s,u]=t.useState("");return t.useImperativeHandle(o,(()=>u),[]),e.jsxs("div",{ref:n,"aria-hidden":!0,style:t.useMemo((()=>({width:l,transform:"translate(0px, 0px)",pointerEvents:"none",userSelect:"none",msUserSelect:"none",WebkitUserSelect:"none",boxSizing:"content-box",textSizeAdjust:"100%",WebkitTextSizeAdjust:"100%",MozTextSizeAdjust:"100%"})),[l]),onClick:S,onMouseDown:S,onMouseUp:S,onMouseOver:S,onMouseOut:S,onMouseMove:S,children:[t.useMemo((()=>i?i(s):s),[s,i]),r]})})),z=t.forwardRef((({children:r,autoHeight:i,style:l,onChange:s,onKeyDown:u,onSelectionChange:c,...a},p)=>{const h=t.useRef(null),f=t.useRef(null),g=t.useRef(null),[[b,v,S,y],z]=t.useState([0,0,0,0]),[T,C]=t.useState(!1),E=t.useRef(""),[[A,W],j]=t.useState([null,null]),R=M((()=>x(h,j))),B=b+S,D=v+y,L=!!(B+D);return t.useImperativeHandle(p,(()=>{const e=h[o],t={get selectionStart(){return R.o()},get selectionEnd(){return R.i()},setRangeText(t,n,o,r){e.setRangeText?e.setRangeText(t,n,o,r):(e.focus(),e.selectionStart=n,e.selectionEnd=o,document.execCommand("insertText",!1,t)),e.dispatchEvent(new Event("input",{bubbles:!0}))}};return new Proxy(e,{get(e,n){if(t[n])return t[n];const o=e[n];return"function"==typeof o?o.bind(e):o},set:(e,t,n)=>(e[t]=n,!0)})}),[]),w((()=>{const e=h[o],t=f[o];if(e&&t)return _(e,t,R,z,C)}),[]),w((()=>{const e=h[o];e&&g[o](e.value)}),[a.value]),w((()=>{const e=h[o],t=f[o];t&&e&&m(e,t,E,l)}),[l]),t.useEffect((()=>{if(null!=A&&null!=W&&c)if(T){const e=n(f[o],A,A+1).getBoundingClientRect();c({focused:!0,top:e.top,left:e.left,height:e.height,selectionStart:A,selectionEnd:W})}else c({focused:!1,selectionStart:A,selectionEnd:W})}),[T,A,W]),t.useEffect((()=>{const e=h[o];i&&e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")})),e.jsxs("div",{style:t.useMemo((()=>{let e=B,t=D;return l&&(d(l.width)&&(e=l.width),d(l.height)&&(t=l.height)),{display:"inline-block",position:"relative",width:e,height:t}}),[B,D,l]),children:[e.jsx("div",{style:t.useMemo((()=>{const e={position:"absolute",overflow:"hidden",top:0,left:0,width:B,height:D};return l?(["background","backgroundColor"].forEach((t=>{l[t]&&(e[t]=l[t])})),e):e}),[B,D,l]),children:e.jsx(k,{u:f,p:g,h:r,g:b})}),e.jsx("textarea",{...a,ref:h,style:t.useMemo((()=>({...l,background:"transparent",margin:0,position:"absolute",...!L&&{position:void 0,verticalAlign:"top"}})),[l,L]),onChange:t.useCallback((e=>{var t;null===(t=g[o])||void 0===t||t.call(g,e.target.value),null==s||s(e)}),[s]),onKeyDown:t.useCallback((e=>{e.nativeEvent.isComposing||229===e.nativeEvent.keyCode||(null==u||u(e),R.t())}),[u])})]})})),T=t.memo((({u:n,p:o,h:i,v:l})=>{const[s,u]=t.useState("");return t.useImperativeHandle(o,(()=>u),[]),e.jsx("div",{ref:n,"aria-hidden":!0,onClick:S,onMouseDown:S,onMouseUp:S,onMouseOver:S,onMouseOut:S,onMouseMove:S,children:e.jsx("div",{style:{height:l},children:e.jsxs("div",{style:t.useMemo((()=>({transform:"translate(0px, 0px)",pointerEvents:"none",userSelect:"none",msUserSelect:"none",WebkitUserSelect:"none",boxSizing:"content-box",textSizeAdjust:"100%",WebkitTextSizeAdjust:"100%",MozTextSizeAdjust:"100%",whiteSpace:"pre"})),[]),children:[t.useMemo((()=>i?i(s):s),[s,i]),r]})})})})),C=t.forwardRef((({children:r,autoHeight:i,style:l,onChange:s,onKeyDown:u,onSelectionChange:c,...a},p)=>{const h=t.useRef(null),f=t.useRef(null),g=t.useRef(null),[[b,v,S,y],k]=t.useState([0,0,0,0]),[z,C]=t.useState(!1),E=t.useRef(""),[[A,W],j]=t.useState([null,null]),R=M((()=>{const e=(()=>{if("undefined"==typeof navigator)return!1;const e=navigator.userAgent.toLowerCase();return e.indexOf("safari")>-1&&e.indexOf("chrome")<=-1})();return x(h,(t=>{if(j(t),e){if(!h[o]||!f[o])return;const{scrollTop:e,scrollLeft:t}=h[o];f[o].style.transform=`translate(${-t}px, ${-e}px)`}}))})),B=b+S,D=v+y,L=!!(B+D);return t.useImperativeHandle(p,(()=>{const e=h[o],t={get selectionStart(){return R.o()},get selectionEnd(){return R.i()},setRangeText(t,n,o,r){e.setRangeText?e.setRangeText(t,n,o,r):(e.focus(),e.selectionStart=n,e.selectionEnd=o,document.execCommand("insertText",!1,t)),e.dispatchEvent(new Event("input",{bubbles:!0}))}};return new Proxy(e,{get(e,n){if(t[n])return t[n];const o=e[n];return"function"==typeof o?o.bind(e):o},set:(e,t,n)=>(e[t]=n,!0)})}),[]),w((()=>{const e=h[o],t=f[o];if(e&&t)return _(e,t,R,k,C)}),[]),w((()=>{const e=h[o];e&&g[o](e.value)}),[a.value]),w((()=>{const e=h[o],t=f[o];t&&e&&m(e,t,E,l)}),[l]),t.useEffect((()=>{if(null!=A&&null!=W&&c)if(z){const e=n(f[o],A,A+1).getBoundingClientRect();c({focused:!0,top:e.top,left:e.left,height:e.height,selectionStart:A,selectionEnd:W})}else c({focused:!1,selectionStart:A,selectionEnd:W})}),[z,A,W]),t.useEffect((()=>{const e=h[o];i&&e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")})),e.jsxs("div",{style:t.useMemo((()=>{let e=B,t=D;return l&&(d(l.width)&&(e=l.width),d(l.height)&&(t=l.height)),{display:"inline-block",position:"relative",width:e,height:t}}),[B,D,l]),children:[e.jsx("div",{style:t.useMemo((()=>{const e={position:"absolute",overflow:"hidden",top:0,left:0,width:B,height:D};return l?(["background","backgroundColor"].forEach((t=>{l[t]&&(e[t]=l[t])})),e):e}),[B,D,l]),children:e.jsx(T,{u:f,p:g,h:r,v})}),e.jsx("input",{...a,ref:h,style:t.useMemo((()=>({...l,background:"transparent",margin:0,position:"absolute",...!L&&{position:void 0,verticalAlign:"top"}})),[l,L]),onChange:t.useCallback((e=>{var t;null===(t=g[o])||void 0===t||t.call(g,e.target.value),null==s||s(e)}),[s]),onKeyDown:t.useCallback((e=>{e.nativeEvent.isComposing||229===e.nativeEvent.keyCode||(null==u||u(e),R.t())}),[u])})]})}));exports.RichTextarea=z,exports.createRegexRenderer=t=>{const n=t.map((([,e])=>e));return o=>{var r;const[i,l,s]=t.reduce(((e,[t,n])=>(((e,t)=>{const n=[];let o=null;for(;o=e.exec(t);)n.push(o);return n})(t,o).forEach((t=>{const o=t.index,r=t.index+t[0].length;e[0].add(o).add(r);let i=e[1].get(o),l=e[2].get(r);i||e[1].set(o,i=[]),l||e[2].set(r,l=[]),i.push(n),l.push(n)})),e)),[new Set,new Map,new Map]),u=Array.from(i);u.sort(((e,t)=>e-t));let c=0;const d=[],a=[];for(let t=0;t<u.length;t++){const i=u[t],p=null!==(r=u[t+1])&&void 0!==r?r:o.length;if(i===p)continue;const h=o.slice(c,i);h&&a.push(h);const f=l.get(i),g=s.get(p);f&&(f.forEach((e=>{d.push(e)})),d.sort(((e,t)=>n.indexOf(t)-n.indexOf(e))));const b=o.slice(i,p);a.push(d.reduceRight(((t,n,o)=>{const r=0===o?i+"":void 0;return"function"==typeof n?n({children:t,value:b,key:r}):e.jsx("span",{style:n,children:t},r)}),b)),g&&g.forEach((e=>{d.splice(d.indexOf(e),1)})),c=p}const p=o.slice(c);return p&&a.push(p),a}},exports.experimental_RichInput=C;
//# sourceMappingURL=index.js.map
